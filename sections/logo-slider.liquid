{% assign rows_offset = section.blocks.size | divided_by: 2 | minus: 1 %}
{% assign rows = section.blocks.size | divided_by: 2 %}

{% capture ticker_list %}
  {% for block in section.blocks %}
    {% if block.settings.logo %}
      <div class="w-48 lg:w-28 px-3 inline-block">
        {% include 'lazy-image' image: block.settings.logo %}
      </div>
    {% endif %}
  {% endfor %}
{% endcapture %}

<div style="background-color: {{ section.settings.bg_col }};" class="overflow-hidden py-14">
    <h4 style="color: {{ section.settings.text_col }};" class="text-3xl md:text-4xl md:mb-10 font-cheltenham-std text-center">{{ section.settings.title | replace: '/strong>', '/span>' | replace: '<strong>', '<span class="text-purple-planera">' }}</h4>

    <div class="overflow-hidden block md:hidden">
      {{ ticker_list }}
    </div>

    <div class="hidden md:block">
      {{ ticker_list }}
    </div>


    {% comment %}
    <div class="overflow-hidden block md:hidden">
        <div class="marquee3k" 
            data-speed="0.25"
            data-reverse="false"
            data-pausable="true">
            <div>
                {{ticker_list}}
            </div>
        </div>
    </div>
    
    <div class="hidden md:block">
        <div 
            @scroll.window="offset = ((-($refs.logo_1_{{ section.id | replace: '-', '_' }}.getBoundingClientRect().top - window.innerHeight) / window.innerHeight) * 20) - 10" 
            x-data="{ offset: (-($refs.logo_1_{{ section.id | replace: '-', '_' }}.getBoundingClientRect().top - window.innerHeight) / window.innerHeight) * 20 }" 
            x-ref="logo_1_{{ section.id | replace: '-', '_' }}"
            :style="{ transform: offset > 11 ? 'translate3d(-11%, 0px, 0px)' : offset < -10 ? 'translate3d(-10%, 0px, 0px)' : 'translate3d(' + offset + '%, 0px, 0px)' }"
            class="flex items-center justify-center whitespace-nowrap">
            {% for i in (0..rows_offset) %}
                {% if section.blocks[i].settings.logo %}
                <div class="min-w-44 mx-3">
                    {% include 'lazy-image' image: section.blocks[i].settings.logo %}
                </div>
                {% endif %}
            {% endfor %}
        </div>
        <div
            @scroll.window="offset = ((-($refs.logo_2_{{ section.id | replace: '-', '_' }}.getBoundingClientRect().top - window.innerHeight) / window.innerHeight) * 20) - 10;" 
            x-data="{ offset: (-($refs.logo_2_{{ section.id | replace: '-', '_' }}.getBoundingClientRect().top - window.innerHeight) / window.innerHeight) * 20 }" 
            x-ref="logo_2_{{ section.id | replace: '-', '_' }}"
            :style="{ transform: offset > 11 ? 'translate3d(-11%, 0px, 0px)' : offset < -10 ? 'translate3d(-10%, 0px, 0px)' : 'translate3d(' + -offset + '%, 0px, 0px)' }"
            class="flex items-center justify-center whitespace-nowrap">
            {% for i in (rows..section.blocks.size) %}
                {% if section.blocks[i].settings.logo %}
                <div class="min-w-44 mx-3">
                    {% include 'lazy-image' image: section.blocks[i].settings.logo %}
                </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
    {% endcomment %}
</div>


{% schema %}
{
    "name": "Logo Slider",
    "settings": [
        {
            "type": "richtext",
            "id": "title",
            "label": "Title",
            "info":"Bold text that should be in purple",
            "default": "<p>As Seen In</p>"
        },
        {
            "type": "color",
            "id": "bg_col",
            "label": "Background Colour"
        },
        {
            "type": "color",
            "id": "text_col",
            "label": "Text Colour"
        }
    ],
    "presets": [
        {
            "category": "Image",
            "name": "Logo Slider"
        }
    ],
    "blocks": [
        {
            "type": "logo",
            "name": "Logo",
            "settings": [
                {
                    "type": "image_picker",
                    "id": "logo",
                    "label": "Logo"
                }
            ]
        }
    ],
    "templates": [
        "index",
        "product",
        "page",
        "cart",
        "article",
        "collection"
    ]
}
{% endschema %}